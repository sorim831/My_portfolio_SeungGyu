# 5주차 ( 2-20 ~ 2-22, 3-1 ~ 3-17 )

## MySQL

### 보안

- SQL 인젝션 공격 : db 모듈의 escape 메서드에 queryData.id를 전달하여 인젝션 공격을 막을 수 있다. ('?' 플레이스홀더도 가능)
- 이스케이핑(Escaping) : 저장된 정보를 사용자에게 출력할 때 공격 의도를 담을 수 있는 스크립트를 sanitizeHtml 라이브러리를 이용해 막을 수 있다.

## Express

- 프레임워크 : 반복적으로 등장하는 기능을 처리할 때 더 적은 코드와 지식으로도 더 많은 일을 더 안전하게 처리할 수 있게 도와주는 도구
- - 프레임워크에 미리 구현된 기능을 사용하는 설계 및 구현
- Express : 기본적인 웹 서버 기능을 제공하며, 다양한 기능을 플러그인 형식으로 확장할 수 있다.

```jsx
/* Hello World 출력 */
const express = require("express"); // 모듈 사용
const app = express(); // express() 함수가 반환하는 값은 익스프레스 프레임워크에서 제공하는 Application 객체

app.get("/", (req, res) => res.send("Hello World")); // 경로(첫 번째 인자), 콜백 함수(두 번째 인자)
app.listen(3000, () => console.log("Example app listening on port 3000")); //첫 번째 인수로 3000 포트 전달, 콟백 함수(두 번재 인자)
```

- 시맨틱 URL : 질의어 없이 경로만 가진 간단한 구조의 URL
  `?id=HTML -> page/HTML`

### 미들웨어(middleware)

- 익스프레스의 핵심 기능 : 라우트, 미들웨어
- 미들웨어 : 요청 객체와 응답 객체 사이에서 코드를 실행하는 함수

#### 미들웨어의 종류

- 애플리케이션 레벨 미들웨어 : 애플리케이션 전체에서 동작하는 미들웨어(use, get, post), 애플리케이션의 모든 요청에 대해 공통된 작업을 수행하는 데 사용
- 라우터 레벨 미들웨어 : 특정 라우터 객체에 대해 동작하는 미들웨어, 특정 경로 또는 라우트 그룹에 대해 공통된 작업을 수행하는 데 사용
- 에러 핸들링 미들웨어 : 에러가 발생했을 때 호출되는 미들웨어, 애플리케이션에서 발생한 에러를 처리하고, 클라이언트에게 적절한 에러 메시지를 반환하는 데 사용
- 내장 미들웨어 : Express에 내장된 미들웨어, 기본 기능을 수행하는 데 사용
- 서드파티 미들웨어 : 특정 기능을 구현하기 위해 사용 (데이터 압축하는 compression, 본문 분석하는 body-parser 미들웨어) <br>  
  미들웨어 함수들은 정의된 순서대로 실행된다. next()를 호출하면 다음 미들웨어로 넘어가고 next()를 호출하지 않으면 그 지점에서 요청 처리가 멈춘다.

### 정적인 파일의 서비스

- 정적인 파일을 서비스할 때에는 해당 파일이 있는 디렉터리를 express.static 메서드에 지정해서 app.use를 사용하면 URL을 통해 해당 디렉터리에 있는 파일이나 디렉터리에 접근할 수 있다. 또한, express.static 메서드에 지정한 디렉터리 외에는 접근할 수 없게 하는 보안 기능도 있다.

### 에러 처리

```jsx
app.use(function (req, res, next) {
  //잘못된 접근이 발생했을 때
  res.status(404).send("Sorry cant find that!");
});
```

```jsx
app.use(function (err, req, res, next) {
  //존재하지 않는 상세보기 페이지로 접속했을 때
  console.error(err.stack);
  res.status(500).send("SomeThing broke!");
});
```

### 라우터

- express() vs express.Router() : express()는 애플리케이션 객체를 리턴하고, express.Router()는 router객체를 리턴

### 보안

- 익스프레스 프레임워크 사용할 때 보안 지침

1. 익스프레스 버전을 최신으로 유지
2. TLS 사용 : 보안이 강화된 HTTPS 프로토콜 사용
3. Helmet 모듈 사용 : 자주 발생하는 보안 이슈 자동으로 해결하는 모듈
4. 쿠키를 안전하게 사용 : 웹 사이트에 누가 방문했는 지 확인할 때 방문자 한 명을 각각 식별
5. 종속 모듈이 안전한 지 확인 : nsp 모듈을 통해 취약점 검사 가능
6. 기타

### 익스프레스 제너레이터

- 프로젝트를 할 때마다 반복되는 작업을 더 쉽게 할 수 있게 기본적인 프로젝트 구성을 지원
